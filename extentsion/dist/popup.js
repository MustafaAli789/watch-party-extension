(()=>{"use strict";var e={714:(e,a)=>{var o,s;Object.defineProperty(a,"__esModule",{value:!0}),a.TabsStorage=a.Messages=a.Page=void 0,(s=a.Page||(a.Page={}))[s.START=0]="START",s[s.MAIN=1]="MAIN",(o=a.Messages||(a.Messages={}))[o.TOBG_VIDEO_ON_SCREEN=0]="TOBG_VIDEO_ON_SCREEN",o[o.SUCCESS=1]="SUCCESS",o[o.FAILURE=2]="FAILURE",o[o.TOBG_CREATE_ROOM_IN_TAB=3]="TOBG_CREATE_ROOM_IN_TAB",o[o.TOFG_VIDEO_ON_SCREEN=4]="TOFG_VIDEO_ON_SCREEN",o[o.TOFG_CREATE_ROOM_IN_TAB=5]="TOFG_CREATE_ROOM_IN_TAB",o[o.TOBG_DISCONNECT=6]="TOBG_DISCONNECT",o[o.TOFG_DISCONNECT=7]="TOFG_DISCONNECT",o[o.TOFG_RETRIEVE_ROOM_DATA=8]="TOFG_RETRIEVE_ROOM_DATA",a.TabsStorage="active_tabs_watchparty"}},a={};function o(s){var r=a[s];if(void 0!==r)return r.exports;var t=a[s]={exports:{}};return e[s](t,t.exports,o),t.exports}(()=>{const e=o(714),a=document.querySelector("#startPage"),s=document.querySelector("#mainPage"),r=document.querySelector("#header"),t=document.querySelector("#mainPage .users"),n=document.querySelector("#startPage .addItemContainer .newRoomBtn"),d=(document.querySelector("#startPage .addItemContainer .joinRoomBtn"),document.querySelector("#mainPage .backBtn")),m=document.querySelector("#mainPage .roomIdContainer .copyImgBtn"),c=document.querySelector("#startPage .addItemContainer .nameInput"),T=document.querySelector("#startPage .addItemContainer .roomInput"),i=document.querySelector("#startPage .addItemContainer .error"),g=document.querySelector("#mainPage .roomIdContainer .roomId"),l=document.querySelector("#mainPage .head .roomName");chrome.storage.local.get(e.TabsStorage,(a=>{var o;let s=a[e.TabsStorage],r={roomName:"",pageType:e.Page.START};(null===(o=s.tabs.find((e=>e.active)))||void 0===o?void 0:o.channelOpen)&&(r.pageType=e.Page.MAIN,chrome.tabs.sendMessage(s.tabs.find((e=>e.active)).id,{message:e.Messages.TOFG_RETRIEVE_ROOM_DATA},(e=>{r.roomId=e.payload.room.roomId,r.roomName=e.payload.room.roomName,E(e.payload.room.users),O(r)}))),O(r)})),n.addEventListener("click",(e=>{_()})),d.addEventListener("click",(a=>{chrome.storage.local.get(e.TabsStorage,(a=>{let o=a[e.TabsStorage].tabs.find((e=>e.active)).id;chrome.runtime.sendMessage({message:e.Messages.TOBG_DISCONNECT}),chrome.tabs.sendMessage(o,{message:e.Messages.TOFG_DISCONNECT}),O({pageType:e.Page.MAIN,roomId:null,roomName:""})}))})),m.addEventListener("click",(()=>{let e=g.innerHTML;navigator.clipboard.writeText(e).then((()=>{}),(()=>{}))}));const _=()=>{chrome.storage.local.get(e.TabsStorage,(a=>{let o=a[e.TabsStorage].tabs.find((e=>e.active)).id;chrome.tabs.sendMessage(o,{message:e.Messages.TOFG_VIDEO_ON_SCREEN},(a=>{if(a.status===e.Messages.SUCCESS&&a.payload&&(""===T.value.trim()?(i.classList.remove("hidden"),i.innerHTML="Please enter a room/id",0):(i.classList.add("hidden"),i.innerHTML="",1))){let a={message:e.Messages.TOFG_CREATE_ROOM_IN_TAB,payload:{roomName:T.value.trim(),userName:c.value}};console.log("hello"),chrome.tabs.sendMessage(o,a,(a=>{console.log("saup"),a.status===e.Messages.SUCCESS&&(chrome.runtime.sendMessage({message:e.Messages.TOBG_CREATE_ROOM_IN_TAB}),O({pageType:e.Page.MAIN,roomId:a.payload.room.roomId,roomName:a.payload.room.roomName}),E(a.payload.room.users))}))}}))}))},O=o=>{o.pageType===e.Page.START?(a.classList.remove("hidden"),s.classList.add("hidden"),r.classList.remove("hidden"),T.value=o.roomName,c.value=""):o.pageType===e.Page.MAIN&&(a.classList.add("hidden"),s.classList.remove("hidden"),r.classList.add("hidden"),l.innerHTML=`${o.roomName}`,g.innerHTML=`${o.roomId}`)},E=e=>{e.forEach((e=>{let a=document.createElement("DIV");a.classList.add("userElem"),a.innerHTML=e.userName,t.append(a)}))}})()})();